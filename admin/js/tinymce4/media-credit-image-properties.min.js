/*! media-credit media-credit-image-properties.js 2017-01-29 9:01:08 PM */
!function(a,b,c){var d,e;b.media.events&&(d=b.Backbone.View.extend({className:"advanced-media-credit",template:b.media.template("media-credit-image-properties"),initialize:function(){b.Backbone.View.prototype.initialize.apply(this,arguments)},prepare:function(){return this.model.toJSON()},render:function(){return b.Backbone.View.prototype.render.apply(this,arguments),this}}),b.media.events.on("editor:frame-create",function(a){e=a.frame,e.on("content:render:image-details",function(a){var b=new d({model:a.model});a.on("post-render",function(){a.views.insert(a.$el.find(".advanced-settings"),b.render().el,{at:1}),$mediaCredit.autoComplete(b,'input[data-setting="mediaCreditText"]',!1)})})}),b.media.events.on("editor:image-edit",function(a){""===a.metadata.mediaCreditText&&""!==a.metadata.mediaCreditAuthorID&&(a.metadata.mediaCreditText=$mediaCredit.id[a.metadata.mediaCreditAuthorID])}),b.media.events.on("editor:image-update",function(a){var b,c,d,f=a.editor,g=f.dom,h=a.image,i=e.content.get().model,j=i.get("align"),k=i.get("width"),l=i.get("mediaCreditText"),m=i.get("mediaCreditAuthorID"),n=i.get("mediaCreditLink"),o=i.get("mediaCreditNoFollow");c=h.parentNode&&"A"===h.parentNode.nodeName?g.getNext(h.parentNode,".mceMediaCreditTemp"):g.getNext(h,".mceMediaCreditTemp"),$mediaCredit.id[m]!==l&&(m=""),b=m?$mediaCredit.id[m]+$mediaCredit.separator+$mediaCredit.organization:l,b=b.replace(/<[^>]+>(.*)<\/[^>]+>/g,"$1"),j="align"+(j||"none"),null===c&&(l||m)&&(c=g.create("span",{class:"mceMediaCreditTemp mceNonEditable","data-media-credit-author-id":m,"data-media-credit-text":l,"data-media-credit-align":j,"data-media-credit-link":n,"data-media-credit-nofollow":o},b),h.parentNode&&"A"===h.parentNode.nodeName?g.insertAfter(c,h.parentNode):g.insertAfter(c,h)),c&&(g.getParent(c,"dl.wp-caption")||(d=g.create("div",{class:"mceMediaCreditOuterTemp "+j,style:"width: "+(parseInt(k)+10)+"px"}),g.insertAfter(d,c.parentNode),g.add(d,c.parentNode),g.remove(c.parentNode,!0)),g.setAttrib(c,"data-media-credit-text",l),g.setAttrib(c,"data-media-credit-author-id",m),g.setAttrib(c,"data-media-credit-link",n),g.setAttrib(c,"data-media-credit-nofollow",o),g.setHTML(c,b))}))}(jQuery,wp,_);